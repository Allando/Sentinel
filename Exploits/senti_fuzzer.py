#!/bin/python

"""
So this will be the fuzzer

Version 1.0: ftp
"""

import sys
import socket
from time import sleep

# Set first argument given at CLI to 'target' variable
target = sys.argv[1]
# create string of 50 A's 'x41'
buff = 'x41' * 50

# loop through sending in a buffer with an increasing length by 50 A's
while True:
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(2)
        s.connect((target, 21))
        s.recv(1024)

        print("Sending buffer with length: {}".format(str(len(buff))))

        # Sned in string 'USER' + the string 'buff'
        s.send("USER " + buff + "rn")
        s.close()
        sleep(1)

        # Increse buff by 50 * x41
        buff = buff + 'x41'*50

    except:
        print("[-] Crash occured with buffer length: {}".format(str(len(buff)-50)))
